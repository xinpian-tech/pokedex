// Auto-generated by gen_do_execute.py

ExecResult do_execute(CoreModel& core, Inst inst, MemCallback mem, NextPc& npc) {
  constexpr bool ext_rv32 = CoreModel::XLEN == 32;
  constexpr bool ext_rv64 = CoreModel::XLEN == 64;
  constexpr bool ext_a = true;
  constexpr bool ext_f = CoreModel::FLEN >= 32;
  constexpr bool ext_d = CoreModel::FLEN >= 64;
  constexpr bool ext_mmode = true;
  constexpr bool ext_smode = false;

  // inst group: I
  if constexpr (true) {
    if (inst.match(0x0000007f, 0x00000037)) {
      // lui
      return EXECUTE_LUI(core, inst, mem, npc);
    }
    if (inst.match(0x0000007f, 0x00000017)) {
      // auipc
      return EXECUTE_AUIPC(core, inst, mem, npc);
    }
    if (inst.match(0x0000007f, 0x0000006f)) {
      // jal
      return EXECUTE_JAL(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00000067)) {
      // jalr
      return EXECUTE_JALR(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00000063)) {
      // beq
      return EXECUTE_BEQ(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00001063)) {
      // bne
      return EXECUTE_BNE(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00004063)) {
      // blt
      return EXECUTE_BLT(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00005063)) {
      // bge
      return EXECUTE_BGE(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00006063)) {
      // bltu
      return EXECUTE_BLTU(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00007063)) {
      // bgeu
      return EXECUTE_BGEU(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00000003)) {
      // lb
      return EXECUTE_LB(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00001003)) {
      // lh
      return EXECUTE_LH(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00002003)) {
      // lw
      return EXECUTE_LW(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00004003)) {
      // lbu
      return EXECUTE_LBU(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00005003)) {
      // lhu
      return EXECUTE_LHU(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00000023)) {
      // sb
      return EXECUTE_SB(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00001023)) {
      // sh
      return EXECUTE_SH(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00002023)) {
      // sw
      return EXECUTE_SW(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00000013)) {
      // addi
      return EXECUTE_ADDI(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00002013)) {
      // slti
      return EXECUTE_SLTI(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00003013)) {
      // sltiu
      return EXECUTE_SLTIU(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00004013)) {
      // xori
      return EXECUTE_XORI(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00006013)) {
      // ori
      return EXECUTE_ORI(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00007013)) {
      // andi
      return EXECUTE_ANDI(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x00000033)) {
      // add
      return EXECUTE_ADD(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x40000033)) {
      // sub
      return EXECUTE_SUB(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x00001033)) {
      // sll
      return EXECUTE_SLL(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x00002033)) {
      // slt
      return EXECUTE_SLT(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x00003033)) {
      // sltu
      return EXECUTE_SLTU(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x00004033)) {
      // xor
      return EXECUTE_XOR(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x00005033)) {
      // srl
      return EXECUTE_SRL(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x40005033)) {
      // sra
      return EXECUTE_SRA(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x00006033)) {
      // or
      return EXECUTE_OR(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x00007033)) {
      // and
      return EXECUTE_AND(core, inst, mem, npc);
    }
  }

  // inst group: I_rv32
  if constexpr (ext_rv32) {
    if (inst.match(0xfe00707f, 0x00001013)) {
      // slli
      return EXECUTE_SLLI(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x00005013)) {
      // srli
      return EXECUTE_SRLI(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x40005013)) {
      // srai
      return EXECUTE_SRAI(core, inst, mem, npc);
    }
  }

  // inst group: I_rv64
  if constexpr (ext_rv64) {
    if (inst.match(0x0000707f, 0x00006003)) {
      // lwu
      return EXECUTE_LWU(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00003003)) {
      // ld
      return EXECUTE_LD(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00003023)) {
      // sd
      return EXECUTE_SD(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x0000001b)) {
      // addiw
      return EXECUTE_ADDIW(core, inst, mem, npc);
    }
    if (inst.match(0xfc00707f, 0x00001013)) {
      // slli
      return EXECUTE_SLLI(core, inst, mem, npc);
    }
    if (inst.match(0xfc00707f, 0x00005013)) {
      // srli
      return EXECUTE_SRLI(core, inst, mem, npc);
    }
    if (inst.match(0xfc00707f, 0x40005013)) {
      // srai
      return EXECUTE_SRAI(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x0000101b)) {
      // slliw
      return EXECUTE_SLLIW(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x0000501b)) {
      // srliw
      return EXECUTE_SRLIW(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x4000501b)) {
      // sraiw
      return EXECUTE_SRAIW(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x0000003b)) {
      // addw
      return EXECUTE_ADDW(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x4000003b)) {
      // subw
      return EXECUTE_SUBW(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x0000103b)) {
      // sllw
      return EXECUTE_SLLW(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x0000503b)) {
      // srlw
      return EXECUTE_SRLW(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x4000503b)) {
      // sraw
      return EXECUTE_SRAW(core, inst, mem, npc);
    }
  }

  // inst group: M
  if constexpr (true) {
    if (inst.match(0xfe00707f, 0x02000033)) {
      // mul
      return EXECUTE_MUL(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x02001033)) {
      // mulh
      return EXECUTE_MULH(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x02002033)) {
      // mulhsu
      return EXECUTE_MULHSU(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x02003033)) {
      // mulhu
      return EXECUTE_MULHU(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x02004033)) {
      // div
      return EXECUTE_DIV(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x02005033)) {
      // divu
      return EXECUTE_DIVU(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x02006033)) {
      // rem
      return EXECUTE_REM(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x02007033)) {
      // remu
      return EXECUTE_REMU(core, inst, mem, npc);
    }
  }

  // inst group: M_rv64
  if constexpr (ext_rv64) {
    if (inst.match(0xfe00707f, 0x0200003b)) {
      // mulw
      return EXECUTE_MULW(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x0200403b)) {
      // divw
      return EXECUTE_DIVW(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x0200503b)) {
      // divuw
      return EXECUTE_DIVUW(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x0200603b)) {
      // remw
      return EXECUTE_REMW(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x0200703b)) {
      // remuw
      return EXECUTE_REMUW(core, inst, mem, npc);
    }
  }

  // inst group: A
  if constexpr (ext_a) {
    if (inst.match(0xf9f0707f, 0x1000202f)) {
      // lr.w
      return EXECUTE_LR_W(core, inst, mem, npc);
    }
    if (inst.match(0xf800707f, 0x1800202f)) {
      // sc.w
      return EXECUTE_SC_W(core, inst, mem, npc);
    }
    if (inst.match(0xf800707f, 0x0800202f)) {
      // amoswap.w
      return EXECUTE_AMOSWAP_W(core, inst, mem, npc);
    }
    if (inst.match(0xf800707f, 0x0000202f)) {
      // amoadd.w
      return EXECUTE_AMOADD_W(core, inst, mem, npc);
    }
    if (inst.match(0xf800707f, 0x2000202f)) {
      // amoxor.w
      return EXECUTE_AMOXOR_W(core, inst, mem, npc);
    }
    if (inst.match(0xf800707f, 0x6000202f)) {
      // amoand.w
      return EXECUTE_AMOAND_W(core, inst, mem, npc);
    }
    if (inst.match(0xf800707f, 0x4000202f)) {
      // amoor.w
      return EXECUTE_AMOOR_W(core, inst, mem, npc);
    }
    if (inst.match(0xf800707f, 0x8000202f)) {
      // amomin.w
      return EXECUTE_AMOMIN_W(core, inst, mem, npc);
    }
    if (inst.match(0xf800707f, 0xa000202f)) {
      // amomax.w
      return EXECUTE_AMOMAX_W(core, inst, mem, npc);
    }
    if (inst.match(0xf800707f, 0xc000202f)) {
      // amominu.w
      return EXECUTE_AMOMINU_W(core, inst, mem, npc);
    }
    if (inst.match(0xf800707f, 0xe000202f)) {
      // amomaxu.w
      return EXECUTE_AMOMAXU_W(core, inst, mem, npc);
    }
  }

  // inst group: A_rv64
  if constexpr (ext_rv64 && ext_a) {
    if (inst.match(0xf9f0707f, 0x1000302f)) {
      // lr.d
      return EXECUTE_LR_D(core, inst, mem, npc);
    }
    if (inst.match(0xf800707f, 0x1800302f)) {
      // sc.d
      return EXECUTE_SC_D(core, inst, mem, npc);
    }
    if (inst.match(0xf800707f, 0x0800302f)) {
      // amoswap.d
      return EXECUTE_AMOSWAP_D(core, inst, mem, npc);
    }
    if (inst.match(0xf800707f, 0x0000302f)) {
      // amoadd.d
      return EXECUTE_AMOADD_D(core, inst, mem, npc);
    }
    if (inst.match(0xf800707f, 0x2000302f)) {
      // amoxor.d
      return EXECUTE_AMOXOR_D(core, inst, mem, npc);
    }
    if (inst.match(0xf800707f, 0x6000302f)) {
      // amoand.d
      return EXECUTE_AMOAND_D(core, inst, mem, npc);
    }
    if (inst.match(0xf800707f, 0x4000302f)) {
      // amoor.d
      return EXECUTE_AMOOR_D(core, inst, mem, npc);
    }
    if (inst.match(0xf800707f, 0x8000302f)) {
      // amomin.d
      return EXECUTE_AMOMIN_D(core, inst, mem, npc);
    }
    if (inst.match(0xf800707f, 0xa000302f)) {
      // amomax.d
      return EXECUTE_AMOMAX_D(core, inst, mem, npc);
    }
    if (inst.match(0xf800707f, 0xc000302f)) {
      // amominu.d
      return EXECUTE_AMOMINU_D(core, inst, mem, npc);
    }
    if (inst.match(0xf800707f, 0xe000302f)) {
      // amomaxu.d
      return EXECUTE_AMOMAXU_D(core, inst, mem, npc);
    }
  }

  // inst group: F
  if constexpr (ext_f) {
    if (inst.match(0x0000707f, 0x00002007)) {
      // flw
      return EXECUTE_FLW(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00002027)) {
      // fsw
      return EXECUTE_FSW(core, inst, mem, npc);
    }
    if (inst.match(0x0600007f, 0x00000043)) {
      // fmadd.s
      return EXECUTE_FMADD_S(core, inst, mem, npc);
    }
    if (inst.match(0x0600007f, 0x00000047)) {
      // fmsub.s
      return EXECUTE_FMSUB_S(core, inst, mem, npc);
    }
    if (inst.match(0x0600007f, 0x0000004b)) {
      // fnmsub.s
      return EXECUTE_FNMSUB_S(core, inst, mem, npc);
    }
    if (inst.match(0x0600007f, 0x0000004f)) {
      // fnmadd.s
      return EXECUTE_FNMADD_S(core, inst, mem, npc);
    }
    if (inst.match(0xfe00007f, 0x00000053)) {
      // fadd.s
      return EXECUTE_FADD_S(core, inst, mem, npc);
    }
    if (inst.match(0xfe00007f, 0x08000053)) {
      // fsub.s
      return EXECUTE_FSUB_S(core, inst, mem, npc);
    }
    if (inst.match(0xfe00007f, 0x10000053)) {
      // fmul.s
      return EXECUTE_FMUL_S(core, inst, mem, npc);
    }
    if (inst.match(0xfe00007f, 0x18000053)) {
      // fdiv.s
      return EXECUTE_FDIV_S(core, inst, mem, npc);
    }
    if (inst.match(0xfff0007f, 0x58000053)) {
      // fsqrt.s
      return EXECUTE_FSQRT_S(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x20000053)) {
      // fsgnj.s
      return EXECUTE_FSGNJ_S(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x20001053)) {
      // fsgnjn.s
      return EXECUTE_FSGNJN_S(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x20002053)) {
      // fsgnjx.s
      return EXECUTE_FSGNJX_S(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x28000053)) {
      // fmin.s
      return EXECUTE_FMIN_S(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x28001053)) {
      // fmax.s
      return EXECUTE_FMAX_S(core, inst, mem, npc);
    }
    if (inst.match(0xfff0007f, 0xc0000053)) {
      // fcvt.w.s
      return EXECUTE_FCVT_W_S(core, inst, mem, npc);
    }
    if (inst.match(0xfff0007f, 0xc0100053)) {
      // fcvt.wu.s
      return EXECUTE_FCVT_WU_S(core, inst, mem, npc);
    }
    if (inst.match(0xfff0707f, 0xe0000053)) {
      // fmv.x.w
      return EXECUTE_FMV_X_W(core, inst, mem, npc);
    }
    if (inst.match(0xfff0707f, 0xe0001053)) {
      // fclass.s
      return EXECUTE_FCLASS_S(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0xa0002053)) {
      // feq.s
      return EXECUTE_FEQ_S(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0xa0001053)) {
      // flt.s
      return EXECUTE_FLT_S(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0xa0000053)) {
      // fle.s
      return EXECUTE_FLE_S(core, inst, mem, npc);
    }
    if (inst.match(0xfff0007f, 0xd0000053)) {
      // fcvt.s.w
      return EXECUTE_FCVT_S_W(core, inst, mem, npc);
    }
    if (inst.match(0xfff0007f, 0xd0100053)) {
      // fcvt.s.wu
      return EXECUTE_FCVT_S_WU(core, inst, mem, npc);
    }
    if (inst.match(0xfff0707f, 0xf0000053)) {
      // fmv.w.x
      return EXECUTE_FMV_W_X(core, inst, mem, npc);
    }
  }

  // inst group: F_rv64
  if constexpr (ext_rv64 && ext_f) {
    if (inst.match(0xfff0007f, 0xc0200053)) {
      // fcvt.l.s
      return EXECUTE_FCVT_L_S(core, inst, mem, npc);
    }
    if (inst.match(0xfff0007f, 0xc0300053)) {
      // fcvt.lu.s
      return EXECUTE_FCVT_LU_S(core, inst, mem, npc);
    }
    if (inst.match(0xfff0007f, 0xd0200053)) {
      // fcvt.s.l
      return EXECUTE_FCVT_S_L(core, inst, mem, npc);
    }
    if (inst.match(0xfff0007f, 0xd0300053)) {
      // fcvt.s.lu
      return EXECUTE_FCVT_S_LU(core, inst, mem, npc);
    }
  }

  // inst group: D
  if constexpr (ext_d) {
    if (inst.match(0x0000707f, 0x00003007)) {
      // fld
      return EXECUTE_FLD(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00003027)) {
      // fsd
      return EXECUTE_FSD(core, inst, mem, npc);
    }
    if (inst.match(0x0600007f, 0x02000043)) {
      // fmadd.d
      return EXECUTE_FMADD_D(core, inst, mem, npc);
    }
    if (inst.match(0x0600007f, 0x02000047)) {
      // fmsub.d
      return EXECUTE_FMSUB_D(core, inst, mem, npc);
    }
    if (inst.match(0x0600007f, 0x0200004b)) {
      // fnmsub.d
      return EXECUTE_FNMSUB_D(core, inst, mem, npc);
    }
    if (inst.match(0x0600007f, 0x0200004f)) {
      // fnmadd.d
      return EXECUTE_FNMADD_D(core, inst, mem, npc);
    }
    if (inst.match(0xfe00007f, 0x02000053)) {
      // fadd.d
      return EXECUTE_FADD_D(core, inst, mem, npc);
    }
    if (inst.match(0xfe00007f, 0x0a000053)) {
      // fsub.d
      return EXECUTE_FSUB_D(core, inst, mem, npc);
    }
    if (inst.match(0xfe00007f, 0x12000053)) {
      // fmul.d
      return EXECUTE_FMUL_D(core, inst, mem, npc);
    }
    if (inst.match(0xfe00007f, 0x1a000053)) {
      // fdiv.d
      return EXECUTE_FDIV_D(core, inst, mem, npc);
    }
    if (inst.match(0xfff0007f, 0x5a000053)) {
      // fsqrt.d
      return EXECUTE_FSQRT_D(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x22000053)) {
      // fsgnj.d
      return EXECUTE_FSGNJ_D(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x22001053)) {
      // fsgnjn.d
      return EXECUTE_FSGNJN_D(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x22002053)) {
      // fsgnjx.d
      return EXECUTE_FSGNJX_D(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x2a000053)) {
      // fmin.d
      return EXECUTE_FMIN_D(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0x2a001053)) {
      // fmax.d
      return EXECUTE_FMAX_D(core, inst, mem, npc);
    }
    if (inst.match(0xfff0007f, 0x40100053)) {
      // fcvt.s.d
      return EXECUTE_FCVT_S_D(core, inst, mem, npc);
    }
    if (inst.match(0xfff0007f, 0x42000053)) {
      // fcvt.d.s
      return EXECUTE_FCVT_D_S(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0xa2002053)) {
      // feq.d
      return EXECUTE_FEQ_D(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0xa2001053)) {
      // flt.d
      return EXECUTE_FLT_D(core, inst, mem, npc);
    }
    if (inst.match(0xfe00707f, 0xa2000053)) {
      // fle.d
      return EXECUTE_FLE_D(core, inst, mem, npc);
    }
    if (inst.match(0xfff0707f, 0xe2001053)) {
      // fclass.d
      return EXECUTE_FCLASS_D(core, inst, mem, npc);
    }
    if (inst.match(0xfff0007f, 0xc2000053)) {
      // fcvt.w.d
      return EXECUTE_FCVT_W_D(core, inst, mem, npc);
    }
    if (inst.match(0xfff0007f, 0xc2100053)) {
      // fcvt.wu.d
      return EXECUTE_FCVT_WU_D(core, inst, mem, npc);
    }
    if (inst.match(0xfff0007f, 0xd2000053)) {
      // fcvt.d.w
      return EXECUTE_FCVT_D_W(core, inst, mem, npc);
    }
    if (inst.match(0xfff0007f, 0xd2100053)) {
      // fcvt.d.wu
      return EXECUTE_FCVT_D_WU(core, inst, mem, npc);
    }
  }

  // inst group: D_rv64
  if constexpr (ext_rv64 && ext_d) {
    if (inst.match(0xfff0007f, 0xc2200053)) {
      // fcvt.l.d
      return EXECUTE_FCVT_L_D(core, inst, mem, npc);
    }
    if (inst.match(0xfff0007f, 0xc2300053)) {
      // fcvt.lu.d
      return EXECUTE_FCVT_LU_D(core, inst, mem, npc);
    }
    if (inst.match(0xfff0707f, 0xe2000053)) {
      // fmv.x.d
      return EXECUTE_FMV_X_D(core, inst, mem, npc);
    }
    if (inst.match(0xfff0007f, 0xd2200053)) {
      // fcvt.d.l
      return EXECUTE_FCVT_D_L(core, inst, mem, npc);
    }
    if (inst.match(0xfff0007f, 0xd2300053)) {
      // fcvt.d.lu
      return EXECUTE_FCVT_D_LU(core, inst, mem, npc);
    }
    if (inst.match(0xfff0707f, 0xf2000053)) {
      // fmv.d.x
      return EXECUTE_FMV_D_X(core, inst, mem, npc);
    }
  }

  // inst group: Zicsr
  if constexpr (true) {
    if (inst.match(0x0000707f, 0x00001073)) {
      // csrrw
      return EXECUTE_CSRRW(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00002073)) {
      // csrrs
      return EXECUTE_CSRRS(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00003073)) {
      // csrrc
      return EXECUTE_CSRRC(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00005073)) {
      // csrrwi
      return EXECUTE_CSRRWI(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00006073)) {
      // csrrsi
      return EXECUTE_CSRRSI(core, inst, mem, npc);
    }
    if (inst.match(0x0000707f, 0x00007073)) {
      // csrrci
      return EXECUTE_CSRRCI(core, inst, mem, npc);
    }
  }

  // inst group: Zifencei
  if constexpr (true) {
    if (inst.match(0x0000707f, 0x0000100f)) {
      // fence.i
      return EXECUTE_FENCE_I(core, inst, mem, npc);
    }
  }

  // inst group: I_misc
  if constexpr (true) {
    if (inst.match(0xf00fffff, 0x0000000f)) {
      // fence
      return EXECUTE_FENCE(core, inst, mem, npc);
    }
    if (inst.match(0xffffffff, 0x00000073)) {
      // ecall
      return EXECUTE_ECALL(core, inst, mem, npc);
    }
    if (inst.match(0xffffffff, 0x00100073)) {
      // ebreak
      return EXECUTE_EBREAK(core, inst, mem, npc);
    }
  }

  // inst group: Sm
  if constexpr (ext_mmode) {
    if (inst.match(0xffffffff, 0x30200073)) {
      // mret
      return EXECUTE_MRET(core, inst, mem, npc);
    }
    if (inst.match(0xffffffff, 0x10500073)) {
      // wfi
      return EXECUTE_WFI(core, inst, mem, npc);
    }
  }

  // inst group: Ss
  if constexpr (ext_smode) {
    if (inst.match(0xffffffff, 0x10200073)) {
      // sret
      return EXECUTE_SRET(core, inst, mem, npc);
    }
    if (inst.match(0xfe007fff, 0x12000073)) {
      // sfence.vma
      return EXECUTE_SFENCE_VMA(core, inst, mem, npc);
    }
  }

  return ExecResult::illegal_inst();
}
